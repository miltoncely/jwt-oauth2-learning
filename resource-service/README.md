# Resource Service Module

This service acts as a Resource Server, validating JWT tokens signed by `auth-service`.

## Features
- **JWT Validation**: Uses the Public Key to verify signatures.
- **Redis Whitelist Check**: Validates that tokens exist in the active tokens cache.
- **RBAC**: Role-based access control (ADMIN, USER).
- **Granular Authorization**: User-specific resource access control.
- **Endpoints**:
  - `GET /public/info`: Accessible by anyone.
  - `GET /api/secure-data`: Requires a valid JWT with `Bearer` scheme.
  - `GET /api/admin`: Requires ADMIN role.
  - `GET /api/user`: Requires USER role.
  - `GET /api/users/{username}`: Requires matching username (granular auth).

## Configuration
- **Public Key**: Loaded from `src/main/resources/keys/public.pem` (generated by key-generator).
- **Port**: Configured to **8081** in `application.yml`.

## How to Run
1. Run the service:
   ```bash
   ./gradlew :resource-service:bootRun
   ```

## Testing
1. **Public Endpoint**:
   ```bash
   curl http://localhost:8081/public/info
   ```
2. **Secure Endpoint (without token)**:
   ```bash
   curl http://localhost:8081/api/secure-data
   ```
   *Result: 401 Unauthorized*

3. **Secure Endpoint (with token)**:
   ```bash
   TOKEN="<paste_token_here>"
   curl -H "Authorization: Bearer $TOKEN" http://localhost:8081/api/secure-data
   ```
   *Result: JSON with secure data*
